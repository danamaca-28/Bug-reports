âŒ Bug Report: API sequence for user creation + book addition returns 502 Bad Gateway
ID: BUG-API-001
Module: Backend API / BookStore Service
Severity: Critical
Priority: High
Status: Open
Date Reported: 2025-06-21
Environment:

OS: macOS Ventura / Ubuntu 22.04

Browsers: Safari/ Chrome 

Endpoint: https://demoqa.com/BookStore/v1/Books

ğŸ”¥ Description:
When attempting to create a new user, generate a token, and add a book using the exposed POST APIs of the BookStore module, the final request (POST /Books) results in a 502 Bad Gateway HTML response.

This error originates from the backend (nginx), indicating either an internal upstream service failure or misconfigured routing.

ğŸ§ª Steps to Reproduce:
POST /Account/v1/User
â†’ Create a new user successfully
âœ… Response: 201 Created

POST /Account/v1/GenerateToken
â†’ Use correct credentials
âœ… Response: 200 OK
âœ… Token received

POST /BookStore/v1/Books
â†’ Use received token and authorization headers
âŒ Response: 502 Bad Gateway
âŒ Body contains raw HTML:

html
Copy
Edit
<h1>502 Bad Gateway</h1>
<center>nginx/1.17.10 (Ubuntu)</center>
ğŸ˜µ Actual Result:
API request to add a book fails with 502 Bad Gateway

HTML response body is returned instead of JSON

Breaks normal app flow (e.g., adding books to user profile)

âœ… Expected Result:
POST /Books should respond with:

200 OK or 201 Created

JSON payload confirming book addition to userâ€™s profile

ğŸ” Technical Clues:
Upstream service or backend API may be unavailable or misrouted

nginx forwarding may be failing to reach actual handler for /Books

Possible mismatch in backend routing logic, deployment issue, or missing service behind nginx

ğŸ’¡ Recommendation:
Check backend logs for /Books route

Validate if BookStore microservice is reachable behind nginx

Add fallback or graceful error response if service is unavailable

Ensure load balancer/reverse proxy configuration is valid and active

